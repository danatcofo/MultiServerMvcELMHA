@using ElmahLogViewer.Areas.Elmah.Models;
@using System.Web.Helpers;
@model SortModel
@{
    var action = this.ViewContext.GetRouteValue("action");
    // get the filter
    Func<object, object> getFilter = s =>
    {
        if (s == null) return null;
        if (s is string) return s;
        if (s is ServerForm)
        {
            var sf = (ServerForm)s;
            return new
            {
                connectionString = sf.ConnectionString,
                name = sf.Name,
                environment = sf.Environment,
            };
        }
        return string.Empty;
    };
    var current = ViewData["sort"].ToString() == Model.Property;
    var label = string.IsNullOrWhiteSpace(Model.Label) ? Model.Property : Model.Label;
    var dir = SortDirection.Ascending;
    if (current)
    {
        dir = ViewData["sortDir"].ToString() == SortDirection.Ascending.ToString() ? SortDirection.Descending : SortDirection.Ascending;
        label = string.Format("{0} {1}", label, dir);
    }
}
@if (current)
{
    @label
}